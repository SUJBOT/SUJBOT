{
  "vl": {
    "jina_model": "jina-embeddings-v4",
    "dimensions": 2048,
    "default_k": 5,
    "page_image_dpi": 150,
    "page_image_format": "png",
    "page_store_dir": "data/vl_pages",
    "source_pdf_dir": "data",
    "max_pages_per_query": 8,
    "image_tokens_per_page": 1600
  },
  "models": {
    "llm_model": "gpt-4o-mini",
    "llm_provider": "openai",
    "embedding_model": "Qwen/Qwen3-Embedding-8B",
    "embedding_provider": "deepinfra"
  },
  "storage": {
    "backend": "postgresql",
    "storage_layers": [
      1,
      2,
      3
    ],
    "postgresql": {
      "connection_string_env": "DATABASE_URL",
      "pool_size": 20,
      "dimensions": 2048
    }
  },
  "embedding": {
    "batch_size": 64,
    "cache_enabled": true,
    "cache_size": 1000,
    "normalize": true
  },
  "agent": {
    "model": "Qwen/Qwen2.5-72B-Instruct",
    "max_tokens": 8192,
    "temperature": 0.3,
    "enable_tool_validation": true,
    "debug_mode": false,
    "vector_store_path": "vector_db",
    "enable_prompt_caching": true,
    "enable_context_management": true,
    "context_management_trigger": 50000,
    "context_management_keep": 3,
    "query_expansion_model": "gpt-4o-mini"
  },
  "agent_tools": {
    "default_k": 6,
    "enable_reranking": false,
    "reranker_candidates": 50,
    "reranker_model": "bge-reranker-large",
    "max_document_compare": 3,
    "compliance_threshold": 0.7,
    "context_window": 2,
    "lazy_load_reranker": false,
    "cache_embeddings": true
  },
  "cli": {
    "show_citations": true,
    "citation_format": "inline",
    "show_tool_calls": true,
    "show_timing": true,
    "enable_streaming": true,
    "save_history": true,
    "history_file": ".agent_history",
    "max_history_items": 1000
  },
  "pipeline": {
    "log_level": "INFO",
    "log_file": "logs/pipeline.log",
    "data_dir": "data",
    "output_dir": "output"
  },
  "multi_agent": {
    "enabled": true,
    "orchestrator": {
      "model": "Qwen/Qwen2.5-72B-Instruct",
      "max_tokens": 1024,
      "temperature": 0.1,
      "enable_prompt_caching": true,
      "system_prompt_file": "prompts/agents/orchestrator.txt"
    },
    "agents": {
      "extractor": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 2048,
        "temperature": 0.2,
        "timeout_seconds": 30,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "expand_context",
          "get_document_info"
        ],
        "system_prompt_file": "prompts/agents/extractor.txt"
      },
      "classifier": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 1024,
        "temperature": 0.2,
        "timeout_seconds": 20,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "get_document_list"
        ],
        "system_prompt_file": "prompts/agents/classifier.txt"
      },
      "compliance": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 3072,
        "temperature": 0.1,
        "timeout_seconds": 45,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "expand_context",
          "get_document_info"
        ],
        "system_prompt_file": "prompts/agents/compliance.txt"
      },
      "risk_verifier": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 2048,
        "temperature": 0.2,
        "timeout_seconds": 45,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "expand_context",
          "get_document_info"
        ],
        "system_prompt_file": "prompts/agents/risk_verifier.txt"
      },
      "citation_auditor": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 1024,
        "temperature": 0.1,
        "timeout_seconds": 25,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "get_document_info"
        ],
        "system_prompt_file": "prompts/agents/citation_auditor.txt"
      },
      "requirement_extractor": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 2048,
        "temperature": 0.1,
        "timeout_seconds": 45,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "expand_context",
          "get_document_info"
        ],
        "system_prompt_file": "prompts/agents/requirement_extractor.txt"
      },
      "gap_synthesizer": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 3072,
        "temperature": 0.3,
        "timeout_seconds": 60,
        "enable_prompt_caching": true,
        "tools": [
          "search",
          "expand_context",
          "get_document_info"
        ],
        "system_prompt_file": "prompts/agents/gap_synthesizer.txt"
      },
      "report_generator": {
        "model": "Qwen/Qwen2.5-72B-Instruct",
        "max_tokens": 4096,
        "temperature": 0.3,
        "timeout_seconds": 30,
        "enable_prompt_caching": true,
        "tools": [
          "get_stats",
          "get_document_list"
        ],
        "system_prompt_file": "prompts/agents/report_generator.txt"
      }
    },
    "routing": {
      "complexity_threshold_low": 30,
      "complexity_threshold_high": 70,
      "enable_parallel_execution": true,
      "max_parallel_agents": 5,
      "complexity_model": "Qwen/Qwen2.5-72B-Instruct"
    },
    "caching": {
      "enable_regulatory_cache": true,
      "enable_contract_cache": true,
      "enable_system_cache": true,
      "cache_ttl_hours": 24,
      "regulatory_docs_path": "data/regulatory_templates",
      "contract_templates_path": "data/contract_templates"
    },
    "checkpointing": {
      "backend": "postgresql",
      "postgresql": {
        "connection_string_env": "DATABASE_URL",
        "table_name": "agent_checkpoints"
      },
      "enable_state_snapshots": true,
      "snapshot_interval_queries": 5,
      "recovery_window_hours": 24
    },
    "langsmith": {
      "enabled": true,
      "api_key_env": "LANGSMITH_API_KEY",
      "project_name": "sujbot-multi-agent",
      "trace_logging_level": "INFO",
      "sample_rate": 1.0
    },
    "clarification": {
      "enabled": false,
      "policy": {
        "trigger_after_agent": "extractor",
        "quality_threshold": 0.60,
        "min_complexity_score": 40,
        "always_ask_if_zero_results": true,
        "never_ask_for_simple_queries": true,
        "max_clarifications_per_query": 2
      },
      "quality_detection": {
        "require_multiple_failures": true,
        "min_failing_metrics": 2,
        "metrics": {
          "retrieval_score": {
            "enabled": true,
            "weight": 0.30,
            "threshold": 0.65
          },
          "semantic_coherence": {
            "enabled": true,
            "weight": 0.25,
            "threshold": 0.30
          },
          "query_pattern": {
            "enabled": true,
            "weight": 0.25,
            "threshold": 0.50
          },
          "document_diversity": {
            "enabled": true,
            "weight": 0.20,
            "threshold": 5.0
          }
        }
      },
      "question_generation": {
        "model": "claude-haiku-4-5-20251001",
        "temperature": 0.4,
        "max_tokens": 512,
        "min_questions": 2,
        "max_questions": 5,
        "enable_prompt_caching": true
      },
      "user_interaction": {
        "timeout_seconds": 300,
        "allow_skip": true,
        "enable_multi_round": true,
        "max_rounds": 2
      },
      "query_enrichment": {
        "strategy": "append_with_context",
        "template": "{original_query}\\n\\n[Context]: {user_response}",
        "max_enriched_length": 500
      }
    },
    "cost_optimization": {
      "enable_cost_tracking": true,
      "enable_model_selection": false,
      "budget_cents_per_query": 100,
      "model_preference": "cost",
      "fallback_model": "claude-haiku-4-5-20251001"
    },
    "evaluation": {
      "enable_trajectory_capture": true,
      "enable_llm_judge": true,
      "llm_judge_model": "claude-haiku-4-5",
      "llm_judge_metrics": [
        "relevance",
        "faithfulness",
        "completeness"
      ],
      "trajectory_max_steps": 100,
      "send_feedback_to_langsmith": true
    }
  },
  "single_agent": {
    "model": "claude-haiku-4-5-20251001",
    "max_tokens": 4096,
    "temperature": 0.3,
    "max_iterations": 10,
    "enable_prompt_caching": true
  },
  "model_registry": {
    "llm_models": {
      "haiku": {
        "id": "claude-haiku-4-5-20251001",
        "provider": "anthropic",
        "pricing": {"input": 1.00, "output": 5.00},
        "context_window": 200000,
        "supports_caching": true
      },
      "sonnet": {
        "id": "claude-sonnet-4-5-20250929",
        "provider": "anthropic",
        "pricing": {"input": 3.00, "output": 15.00},
        "context_window": 200000,
        "supports_caching": true
      },
      "opus": {
        "id": "claude-opus-4-5-20251101",
        "provider": "anthropic",
        "pricing": {"input": 5.00, "output": 25.00},
        "context_window": 200000,
        "supports_caching": true,
        "supports_extended_thinking": true
      },
      "gpt-4o": {
        "id": "gpt-4o",
        "provider": "openai",
        "pricing": {"input": 2.50, "output": 10.00},
        "context_window": 128000
      },
      "gpt-4o-mini": {
        "id": "gpt-4o-mini",
        "provider": "openai",
        "pricing": {"input": 0.15, "output": 0.60},
        "context_window": 128000
      },
      "o1": {
        "id": "o1",
        "provider": "openai",
        "pricing": {"input": 15.00, "output": 60.00},
        "context_window": 200000
      },
      "o1-mini": {
        "id": "o1-mini",
        "provider": "openai",
        "pricing": {"input": 3.00, "output": 12.00},
        "context_window": 128000
      },
      "o3-mini": {
        "id": "o3-mini",
        "provider": "openai",
        "pricing": {"input": 3.00, "output": 12.00},
        "context_window": 200000
      },
      "gemini-flash": {
        "id": "gemini-2.5-flash",
        "provider": "google",
        "pricing": {"input": 0.30, "output": 2.50},
        "context_window": 1000000
      },
      "gemini-pro": {
        "id": "gemini-2.5-pro",
        "provider": "google",
        "pricing": {"input": 1.25, "output": 10.00},
        "context_window": 1000000
      },
      "gemini-flash-lite": {
        "id": "gemini-2.5-flash-lite",
        "provider": "google",
        "pricing": {"input": 0.10, "output": 0.40},
        "context_window": 1000000
      },
      "qwen-vl-32b": {
        "id": "Qwen/Qwen2.5-VL-32B-Instruct",
        "provider": "deepinfra",
        "pricing": {"input": 0.20, "output": 0.60},
        "context_window": 128000,
        "supports_vision": true
      },
      "qwen3-vl-235b": {
        "id": "Qwen/Qwen3-VL-235B-A22B-Instruct",
        "provider": "deepinfra",
        "pricing": {"input": 0.20, "output": 0.88},
        "context_window": 262144,
        "supports_vision": true
      }
    },
    "embedding_models": {
      "text-embedding-3-large": {
        "id": "text-embedding-3-large",
        "provider": "openai",
        "pricing": {"input": 0.13, "output": 0.0},
        "dimensions": 3072
      },
      "text-embedding-3-small": {
        "id": "text-embedding-3-small",
        "provider": "openai",
        "pricing": {"input": 0.02, "output": 0.0},
        "dimensions": 1536
      },
      "text-embedding-ada-002": {
        "id": "text-embedding-ada-002",
        "provider": "openai",
        "pricing": {"input": 0.10, "output": 0.0},
        "dimensions": 1536
      },
      "voyage-3-large": {
        "id": "voyage-3-large",
        "provider": "voyage",
        "pricing": {"input": 0.12, "output": 0.0},
        "dimensions": 1024
      },
      "voyage-3": {
        "id": "voyage-3",
        "provider": "voyage",
        "pricing": {"input": 0.06, "output": 0.0},
        "dimensions": 1024
      },
      "voyage-3-lite": {
        "id": "voyage-3-lite",
        "provider": "voyage",
        "pricing": {"input": 0.02, "output": 0.0},
        "dimensions": 512
      },
      "voyage-law-2": {
        "id": "voyage-law-2",
        "provider": "voyage",
        "pricing": {"input": 0.12, "output": 0.0},
        "dimensions": 1024
      },
      "bge-m3": {
        "id": "BAAI/bge-m3",
        "provider": "huggingface",
        "pricing": {"input": 0.0, "output": 0.0},
        "dimensions": 1024,
        "is_local": true
      },
      "bge-large": {
        "id": "BAAI/bge-large-en-v1.5",
        "provider": "huggingface",
        "pricing": {"input": 0.0, "output": 0.0},
        "dimensions": 1024,
        "is_local": true
      },
      "bge-base": {
        "id": "BAAI/bge-base-en-v1.5",
        "provider": "huggingface",
        "pricing": {"input": 0.0, "output": 0.0},
        "dimensions": 768,
        "is_local": true
      },
      "bge-small": {
        "id": "BAAI/bge-small-en-v1.5",
        "provider": "huggingface",
        "pricing": {"input": 0.0, "output": 0.0},
        "dimensions": 384,
        "is_local": true
      },
      "qwen3-embedding": {
        "id": "Qwen/Qwen3-Embedding-8B",
        "provider": "deepinfra",
        "pricing": {"input": 0.03, "output": 0.0},
        "dimensions": 4096
      },
      "jina-v4": {
        "id": "jina-embeddings-v4",
        "provider": "jina",
        "pricing": {"input": 0.02, "output": 0.00},
        "dimensions": 2048
      }
    },
    "reranker_models": {
      "ms-marco-mini": {
        "id": "cross-encoder/ms-marco-MiniLM-L-6-v2",
        "is_local": true
      },
      "ms-marco-base": {
        "id": "cross-encoder/ms-marco-MiniLM-L-12-v2",
        "is_local": true
      },
      "bge-reranker-base": {
        "id": "BAAI/bge-reranker-base",
        "is_local": true
      },
      "bge-reranker-large": {
        "id": "BAAI/bge-reranker-large",
        "is_local": true
      },
      "bge-reranker-v2-m3": {
        "id": "BAAI/bge-reranker-v2-m3",
        "is_local": true
      }
    },
    "embedding_dimensions": {}
  },
  "defaults": {
    "timeouts": {
      "api_request": 60,
      "ollama_request": 30,
      "postgres_command": 60,
      "batch_api_poll": 30
    },
    "retries": {
      "api_max_retries": 3,
      "postgres_max_retries": 5
    },
    "pool_sizes": {
      "postgres": 20
    },
    "batch_sizes": {
      "embedding": 64
    },
    "cache": {
      "embedding_cache_max_size": 1000,
      "token_manager_max_tokens_per_chunk": 600
    }
  },
  "agent_variants": {
    "variants": {
      "remote": {
        "display_name": "Remote (Sonnet 4.5)",
        "model": "claude-sonnet-4-5-20250929"
      },
      "local": {
        "display_name": "Local (Qwen3 VL 235B)",
        "model": "Qwen/Qwen3-VL-235B-A22B-Instruct"
      }
    },
    "default_variant": "remote",
    "deepinfra_supported_models": [
      "Qwen/Qwen2.5-VL-32B-Instruct",
      "Qwen/Qwen3-VL-235B-A22B-Instruct"
    ]
  },
  "security_monitoring": {
    "enabled": true,
    "schedule": {
      "regular_checks": ["6:00", "10:00", "14:00", "18:00"],
      "daily_summary": "22:00",
      "timezone": "Europe/Prague"
    },
    "environments": {
      "prod": {
        "container_prefix": "sujbot_",
        "containers": [
          "sujbot_postgres",
          "sujbot_redis",
          "sujbot_backend",
          "sujbot_frontend",
          "sujbot_nginx"
        ],
        "health_endpoint": "http://localhost:8000/health",
        "ssl_enabled": true
      },
      "dev": {
        "container_prefix": "sujbot_dev_",
        "containers": [
          "sujbot_dev_postgres",
          "sujbot_dev_redis",
          "sujbot_dev_backend",
          "sujbot_dev_frontend",
          "sujbot_dev_nginx"
        ],
        "health_endpoint": "http://localhost:8100/health",
        "ssl_enabled": false
      }
    },
    "checks": {
      "docker_health": {
        "enabled": true,
        "containers": [
          "sujbot_postgres",
          "sujbot_redis",
          "sujbot_backend",
          "sujbot_frontend",
          "sujbot_nginx"
        ],
        "memory_warning_percent": 80,
        "memory_critical_percent": 90
      },
      "log_analysis": {
        "enabled": true,
        "log_since_regular": "4h",
        "log_since_daily": "24h",
        "suspicious_patterns": [
          "ERROR",
          "CRITICAL",
          "failed login",
          "authentication failed",
          "connection refused",
          "permission denied",
          "out of memory"
        ],
        "max_log_lines": 500
      },
      "system_resources": {
        "enabled": true,
        "disk_warning_percent": 80,
        "disk_critical_percent": 90
      },
      "health_endpoints": {
        "enabled": true,
        "endpoints": [
          {
            "name": "Backend",
            "url": "http://localhost:8000/health",
            "timeout_seconds": 10
          }
        ]
      },
      "ssl_certificate": {
        "enabled": true,
        "warning_days_before_expiry": 30,
        "critical_days_before_expiry": 7,
        "cert_path": "/etc/letsencrypt/live/sujbot.fjfi.cvut.cz/fullchain.pem"
      }
    },
    "notifications": {
      "email": {
        "enabled": false,
        "recipients": ["sujbot.fjfi@gmail.com"],
        "smtp_host": "smtp.gmail.com",
        "smtp_port": 587,
        "smtp_user_env": "GMAIL_USER",
        "smtp_password_env": "GMAIL_APP_PASSWORD",
        "from_address": "sujbot.fjfi@gmail.com",
        "subject_prefix": "[SUJBOT Monitor]"
      },
      "teams": {
        "enabled": true,
        "channels": [
          {
            "name": "monitoring",
            "webhook_url_env": "TEAMS_WEBHOOK_URL",
            "severity": ["critical", "warning", "healthy"]
          }
        ]
      },
      "severity_filter": {
        "email_on": ["critical", "warning"],
        "teams_on": ["critical", "warning", "healthy"]
      }
    },
    "claude_settings": {
      "prompt_file": "prompts/security_monitor.txt",
      "daily_prompt_file": "prompts/security_monitor_daily.txt",
      "allowed_tools": ["Bash", "Read", "Grep"],
      "timeout_seconds": 120
    },
    "logging": {
      "log_dir": "./logs/sujbot-security",
      "retention_days": 30
    }
  }
}
